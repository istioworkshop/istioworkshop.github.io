
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Service metrics Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Jaeger.html" />
    
    
    <link rel="prev" href="../setup/test-application.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../hints.html">
            
                <a href="../hints.html">
            
                    
                    Workshop hints
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Setup</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../setup/kubernetes.html">
            
                <a href="../setup/kubernetes.html">
            
                    
                    Provision a K8S cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../setup/istio.html">
            
                <a href="../setup/istio.html">
            
                    
                    Install Istio Service Mesh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../setup/test-application.html">
            
                <a href="../setup/test-application.html">
            
                    
                    Deploy test application
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Observability</li>
        
        
    
        <li class="chapter active" data-level="3.1" data-path="grafana.html">
            
                <a href="grafana.html">
            
                    
                    Service metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="Jaeger.html">
            
                <a href="Jaeger.html">
            
                    
                    Distributed tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="kiali.html">
            
                <a href="kiali.html">
            
                    
                    Mesh topology
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Traffic management</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../traffic-management/ingress-gateway.html">
            
                <a href="../traffic-management/ingress-gateway.html">
            
                    
                    Ingress gateway
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../traffic-management/traffic-routing.html">
            
                <a href="../traffic-management/traffic-routing.html">
            
                    
                    Traffic routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../traffic-management/traffic-shifting.html">
            
                <a href="../traffic-management/traffic-shifting.html">
            
                    
                    Traffic shifting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../traffic-management/fault-injection.html">
            
                <a href="../traffic-management/fault-injection.html">
            
                    
                    Fault injection
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Cleanup</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../cleanup/stop.html">
            
                <a href="../cleanup/stop.html">
            
                    
                    Stop the cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../cleanup/destroy.html">
            
                <a href="../cleanup/destroy.html">
            
                    
                    Destroy the cluster
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Service metrics</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="inspect-service-metrics-in-grafana">Inspect service metrics in Grafana</h1>
<p><em>This chapter presents how to monitor service mesh traffic using the Grafana Istio addon.</em></p>
<h2 id="outline">Outline</h2>
<p>In this chapter you will learn:</p>
<ul>
<li>How to access the Grafana dashboard.</li>
<li>How to analyze service mesh traffic globally.</li>
<li>How to analyze traffic for a particular application service.</li>
<li>How to monitor the operation of individual components in Istio control plane.</li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<p>Most of the service mesh metrics are collected through the presence of a sidecar proxy installed in each application pod.</p>
<p>Each proxy generates a rich set of metrics describing the inbound and outbound traffic passing through the proxy. They also provide detailed statistics about the administrative functions of the proxy itself, including configuration and health information.</p>
<p>In addition, Istio provides a set of aggregated service-oriented metrics for monitoring inter-service communication. These metrics cover the four fundamental service health indicators: latency, traffic, errors, and saturation.</p>
<p>The Istio control plane also provides a collection of self-monitoring metrics. These metrics allow monitoring the behavior of Istio itself.</p>
<h3 id="access-the-dashboard">Access the dashboard</h3>
<p>Port-forward the Grafana dashboard to your local machine:</p>
<pre><code>$ istioctl dashboard grafana
</code></pre><p>Your browser should startup automatically and display the dashboard. Otherwise, visit the address:
<a href="http://localhost:3000" target="_blank">http://localhost:3000</a>.</p>
<h3 id="analyze-mesh-dashboard">Analyze mesh dashboard</h3>
<p>Navigate to the <a href="http://localhost:3000/d/G8wLrJIZk/istio-mesh-dashboard" target="_blank"><strong>Mesh Dashboard</strong></a>. It
should look similar to:</p>
<p><img src="../assets/images/grafana-mesh-dashboard-1.png" alt=""></p>
<p>The dashboard provides the global view of the service mesh:</p>
<ul>
<li>total number of discovered services,</li>
<li>global request volume expressed in <em>operations per second</em> (ops),</li>
<li>global success rate - percentage of requests completed with success,</li>
<li>total failed requests - number of requests ended with 4xx and 5xx HTTP error codes.</li>
</ul>
<p>In addition, the dashboard provides essential metrics for the discovered services:</p>
<ul>
<li>operations per second,</li>
<li>p50, p90, p99 latency,</li>
<li>success rate.</li>
</ul>
<h3 id="analyze-service-dashboard">Analyze service dashboard</h3>
<p>Navigate to the <a href="http://localhost:3000/d/LJ_uJAvmk/istio-service-dashboard" target="_blank"><strong>Service Dashboard</strong></a>
and pick the <code>productcatalog</code> service from the <em>Service</em> dropdown.</p>
<p>The dashboard should look similar to:</p>
<p><img src="../assets/images/grafana-service-dashboard-1.png" alt="">
<img src="../assets/images/grafana-service-dashboard-2.png" alt=""></p>
<p>The dashboard provides detailed metrics for the selected service:</p>
<ul>
<li>client/server request volume,</li>
<li>client/server success rate,</li>
<li>client/server request duration,</li>
<li>incoming requests by source,</li>
<li>incoming success rate by source,</li>
<li>incoming request duration by source,</li>
<li>incoming request size by source,</li>
<li>TCP received/sent bytes (only for raw TCP traffic).</li>
</ul>
<p>Note that you can use the <em>Service</em> dropdown to switch between inspected services. Moreover, you can
view the metrics in the context of a particular service client by using the <em>Client workload</em>
dropdown.</p>
<h3 id="analyze-pilot-dashboard">Analyze Pilot dashboard</h3>
<p>Navigate to the
<a href="http://localhost:3000/d/3--MLVZZk/istio-pilot-dashboard?orgId=1&amp;refresh=5m" target="_blank"><strong>Pilot Dashboard</strong></a>.</p>
<p>It provides metrics related to Istio Pilot component deployed in the Istio control plane.</p>
<p>The first part of the dashboard describes the usage of system resources (CPU, memory, disk):</p>
<p><img src="../assets/images/grafana-pilot-dashboard-1.png" alt=""></p>
<p>The second part presents metrics specific to Pilot operation, for instance:</p>
<ul>
<li>Pilot pushes - frequency of configuration distribution to sidecar proxies,</li>
<li>Pilot errors - number of errors encountered during configuration rendering and distrubution,</li>
<li>Proxy push time - time needed to synchronize configuration to a proxy.</li>
</ul>
<p><img src="../assets/images/grafana-pilot-dashboard-2.png" alt=""></p>
<p>Note, each component in the control plane provides a similar monitoring dashboard:</p>
<p><img src="../assets/images/grafana-all-dashboards.png" alt=""></p>
<p>Inspect them to identify what metrics are avilable for Galey, Citadel and Mixer.</p>
<h2 id="exercises">Exercises</h2>
<p>Use the presented Grafana dashboards to answer the following questions:</p>
<ol>
<li>How many ops are being currently processed by the application?</li>
<li>What is the global success rate?</li>
<li>Are there any request errors occurring in the application at the moment? How do you check that?</li>
<li>Which application service processes the most requests? What is its p99 latency and success rate?</li>
<li>What is the current CPU and memory usage by Istio Pilot?</li>
<li>Does Istio Pilot encouteres any errors at the moment?</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../setup/test-application.html" class="navigation navigation-prev " aria-label="Previous page: Deploy test application">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Jaeger.html" class="navigation navigation-next " aria-label="Next page: Distributed tracing">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Service metrics","level":"3.1","depth":1,"next":{"title":"Distributed tracing","level":"3.2","depth":1,"path":"observability/Jaeger.md","ref":"observability/Jaeger.md","articles":[]},"previous":{"title":"Deploy test application","level":"2.3","depth":1,"path":"setup/test-application.md","ref":"setup/test-application.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"observability/grafana.md","mtime":"2020-06-07T09:34:44.160Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-25T21:46:32.291Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

